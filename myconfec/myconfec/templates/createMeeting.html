<!DOCTYPE html>
<html lang="en">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <!-- Meta, title, CSS, favicons, etc. -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>{{ title }}! | </title>

    <!-- Bootstrap core CSS -->

    <link href="{{ STATIC_URL}}css/bootstrap.min.css" rel="stylesheet">

    <link href="{{ STATIC_URL}}fonts/css/font-awesome.min.css" rel="stylesheet">
    <link href="{{ STATIC_URL}}css/animate.min.css" rel="stylesheet">

    <link href="{{ STATIC_URL}}css/bootstrap-datetimepicker.min.css" rel="stylesheet">
    <!-- Custom styling plus plugins -->
    <link href="{{ STATIC_URL}}css/custom.css" rel="stylesheet">
    <link href="{{ STATIC_URL}}css/icheck/flat/green.css" rel="stylesheet">

    <script src="{{ STATIC_URL}}js/jquery.min.js"></script>
<!--
    <script src="https://code.jquery.com/jquery-2.2.0.min.js"></script>
-->
    <!--[if lt IE 9]>
        <script src="../assets/js/ie8-responsive-file-warning.js"></script>
        <![endif]-->

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
          <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
          <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
        <![endif]-->

</head>
<style>
.disabledbutton {
    pointer-events: none;
    opacity: 0.4;
}
</style>

<body class="nav-md">

    <div class="container body">


        <div class="main_container">

	{% include 'sidebar.html' %}
              <!-- page content -->
            <div class="right_col" role="main">

                <div class="">
                    <div class="page-title">
                        <div class="title_left">
                            <h3>Create Meeting</h3>
                        </div>

                        <!-- <div class="title_right">
                            <div class="col-md-5 col-sm-5 col-xs-12 form-group pull-right top_search">
                                <div class="input-group">
                                    <input type="text" class="form-control" placeholder="Search for...">
                                    <span class="input-group-btn">
				        <button class="btn btn-default" type="button">Go!</button>
				    </span>
                                </div>
                            </div>
						   
                        </div>
			-->
                    </div>
                    <div class="clearfix"></div>

                    <div class="row">

                        <div class="col-md-12 col-sm-12 col-xs-12">
                            <div class="x_panel">
                                <div class="x_title">
                                    <h2>Creating meeting is simple</h2>
                                    <!--<ul class="nav navbar-right panel_toolbox">
                                        <li><a class="collapse-link"><i class="fa fa-chevron-up"></i></a>
                                        </li>
                                        <li class="dropdown">
                                            <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false"><i class="fa fa-wrench"></i></a>
                                            <ul class="dropdown-menu" role="menu">
                                                <li><a href="#">Settings 1</a>
                                                </li>
                                                <li><a href="#">Settings 2</a>
                                                </li>
                                            </ul>
                                        </li>
                                        <li><a class="close-link"><i class="fa fa-close"></i></a>
                                        </li>
                                    </ul>
									-->
                                    <div class="clearfix"></div>
                                </div>
                                <div class="x_content">


                                    <!-- Smart Wizard -->
                                    <p>You can create meeting and add participants here.</p>
                                    <div id="wizard" class="create_form form_wizard wizard_horizontal">
                                        <div id="step-1">
                                            <form method="post" id="create_meeting_id"  class="form-horizontal form-label-left">
					{% csrf_token %}
                                                     <!--   <input type="hidden" id="csrfmiddlewaretoken" name="csrfmiddlewaretoken" required="required" class="form-control col-md-7 col-xs-12">
-->
                                                <div class="form-group">
                                                    <label class="control-label col-md-3 col-sm-3 col-xs-12" for="first-name">Meeting Name <span class="required">*</span>
                                                    </label>
                                                    <div class="col-md-6 col-sm-6 col-xs-12">
                                                        <input type="text" id="meeting_name" name="meeting_name" required="required" class="form-control col-md-7 col-xs-12">
                                                    </div>
                                                </div>
                                                <!--<div class="form-group">
                                                    <label class="control-label col-md-3 col-sm-3 col-xs-12" for="last-name">Meeting ID
                                                    </label>
                                                    <div class="col-md-6 col-sm-6 col-xs-12">
                                                        <input type="text" id="meeting_id" name="meeting_id"  class="form-control col-md-7 col-xs-12">
                                                    </div>
                                                </div>-->
                                                <div class="form-group">
                                                    <label class="control-label col-md-3 col-sm-3 col-xs-12">Meeting Time<span class="required">*</span>
                                                    </label>
                                                    <div class="col-md-6 col-sm-6 col-xs-12">
                                                    
							<div class="well">
							  <div id="datetimepicker1" class="input-append date">
   								 <input id="meeting_time" name="meeting_time"  data-format="yyyy-MM-dd hh:mm:ss" type="text"></input>
							        <span class="add-on">
      									<i data-time-icon="icon-time" data-date-icon="icon-calendar">
     									 </i>
   								 </span>
  							  </div>
							</div>
						    </div>
                                                </div>
                                                <!--<div class="form-group">
                                                    <label for="middle-name" class="control-label col-md-3 col-sm-3 col-xs-12">Duration</label>
                                                    <div class="col-md-6 col-sm-6 col-xs-12">
                                                        <input id="meeting_duration" name="meeting_duration" class="form-control col-md-7 col-xs-12" type="text" name="middle-name">
                                                    </div>
                                                </div> -->

                                        </div>
                                        <div id="step-2" class="form-horizontal form-label-left">
                                                <div class="form-group">
                                                    <label class="control-label col-md-3 col-sm-3 col-xs-12" for="first-name">Attendee Password<span class="required">*</span>
                                                    </label>
                                                    <div class="col-md-6 col-sm-6 col-xs-12">
                                                        <input type="text" id="attendee_password" name="attendee_password" required="required" class="form-control col-md-7 col-xs-12">
                                                    </div>
                                                </div>
                                                <div class="form-group">
                                                    <label class="control-label col-md-3 col-sm-3 col-xs-12" for="last-name">Moderator Password
                                                    </label>
                                                    <div class="col-md-6 col-sm-6 col-xs-12">
                                                        <input type="text" id="moderator_password" name="moderator_password"  class="form-control col-md-7 col-xs-12">
                                                    </div>
                                                </div>
                                        </div>


					                     <input type="button" onclick="createMeeting()" value="Create Meeting" class="btn btn-success" id="disableit" />
					
										</form>
                                    </div>
                                    <!-- End SmartWizard Content -->





                                    <h2>Add Participants</h2>
                                    <!-- Tabs -->


                            <!-- Start to do list -->
                            <div class="col-md-6 col-sm-6 col-xs-12">
                                <div class="x_panel">
                                    <div class="x_title">
                                        <h2>Select your colleague.</h2>
                                        
                                        <div class="clearfix"></div>
                                    </div>
                                    <div class="x_content">

                                        <div class="participants_list">
                                            <ul class="to_do">
					 	{% for us in num_of_user %}
						{% if us.username != request.user.username %}
                                                <li>
                                                    <p>
                                                        <input name="participant" value="{{us.username}}"  type="checkbox" class="flatt" /><small> {{ us.username }}</small>
						    </p>
                                                </li>
						{% endif %}
						{% endfor %}
                                                
                                            </ul>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <!-- End to do list -->
							
					        <!-- Add external attendees -->
							
					<div class="col-md-4 col-sm-4 col-xs-12">
                        <div class="x_panel tile fixed_height_320">
                            <div class="x_title">
                                <h2>Invite external Atendees</h2>
                                <div class="clearfix"></div>
                            </div>
                            <div class="x_content">
                                           <form class="form-horizontal external_attendee form-label-left">
						{% csrf_token %}
                                                <div class="form-group">
                                                    <label class="control-label col-md-3 col-sm-3 col-xs-12" for="first-name">Name <span class="required">*</span>
                                                    </label>
                                                    <div class="col-md-6 col-sm-6 col-xs-12">
                                                        <input type="text" id="external_name" name="external_name" required="required" class="form-control col-md-7 col-xs-12">
                                                    </div>
                                                </div>
                                                <div class="form-group">
                                                    <label class="control-label col-md-3 col-sm-3 col-xs-12" for="email-name">Email
                                                    </label>
                                                    <div class="col-md-6 col-sm-6 col-xs-12">
                                                        <input type="text" id="external_emailid" name="external_emailid"  class="form-control col-md-7 col-xs-12">
                                                    </div>
                                                </div>
                                                <div class="form-group">
                                                    <label class="control-label col-md-3 col-sm-3 col-xs-12">Mobile<span class="required">*</span>
                   		                             </label><input type="hidden" name="meetingID" id="meetingID" />
                                                    <div class="col-md-6 col-sm-6 col-xs-12">
                                                        <input id="contact_number" name="contact_number" class="date-picker form-control col-md-7 col-xs-12" required="required" type="text">
                                                    </div>
                                                </div>
						<div class="form-group">
                                                    <div class="col-md-6 col-sm-6 col-xs-12">
					                  <button type="button" onclick="createExternal()"  class="btn btn-round btn-danger" >Invite</button>
                                                    </div>
                                                </div>
								
												
					</form>

                            </div>
                        </div>
                    </div>

										
									
                                    <!-- End SmartWizard Content -->


                                </div>
                            </div>
                        </div>

                    </div>
                </div>
 <input type="button" onclick="window.location.href = '/account/profile/'" value="Complete" class="btn btn-success" id="disableit" />
                
                <!-- footer content -->
            <footer>
                <div class="">
                    <p class="pull-right">All right reserved <a></a>. |
                        <span class="lead"> <i class="fa fa-paw"></i>{{web_name}}!</span>
                    </p>
                </div>
                <div class="clearfix"></div>
            </footer>
            <!-- /footer content -->
                
            </div>
            <!-- /page content -->
        </div>

    </div>

    <div id="custom_notifications" class="custom-notifications dsp_none">
        <ul class="list-unstyled notifications clearfix" data-tabbed_notifications="notif-group">
        </ul>
        <div class="clearfix"></div>
        <div id="notif-group" class="tabbed_notifications"></div>
    </div>

    <script src="{{ STATIC_URL}}js/bootstrap.min.js"></script>

    <!-- chart js -->
    <script src="{{ STATIC_URL}}js/chartjs/chart.min.js"></script>
    <!-- bootstrap progress js -->
<!--    <script src="{{ STATIC_URL}}js/progressbar/bootstrap-progressbar.min.js"></script>
    <script src="{{ STATIC_URL}}js/nicescroll/jquery.nicescroll.min.js"></script>
   --> <!-- icheck -->
    <script src="{{ STATIC_URL}}js/icheck/icheck.min.js"></script>

    <script src="{{ STATIC_URL}}js/custom.js"></script>
    <!-- form wizard -->

    <script src="{{ STATIC_URL}}js/bootstrap-datetimepicker.min.js"></script>
<!--    <script src="{{ STATIC_URL}}js/dp.js"></script>
--><script type="text/javascript">
$(function() {
    $('#datetimepicker1').datetimepicker({
      language: 'pt-BR'
    });
  });
var meetingID = null; 

function ajaxCallBack(retString){
    meetingID = retString;
}
function createMeeting(){   
    var url = "/meeting/create"; // the script where you handle the form input.
    $.ajax({
           type: "POST",
           url: url,
           data: $("#create_meeting_id").serialize(), // serializes the form's elements.
	   
           success: function(data)
           {
		var data = JSON.parse(data);
		ajaxCallBack(data.meeting_id);
		$("#meetingID").val(data.meeting_id);
		$("#wizard").addClass("disabledbutton");	      
               alert( 'Meeting '+ data.name  + ' Created Successfully Please add participants below'); // show response from the php script.
	       
           }
         });
}

function createExternal(){
    data =  $(".external_attendee").serialize();
    data['meetingID'] = meetingID;
    var url = "/meeting/add_external_attendee"; // the script where you handle the form input.
    $.ajax({
           type: "POST",
           url: url,
           data: data, //$(".external_attendee").serialize(), // serializes the form's elements.
           
           success: function(data)
           {
                var data = JSON.parse(data);
               alert( 'User '+ data.name  + ' Invited Successfully'); // show response from the php script.
               
           }
         });

}  
$('.flatt').change(function(){
    var c = this.checked;
    url = '/meeting/add_participant';
     if(c){
       var id = $(this).val(); // this gives me null
        $.ajax({
           type: "POST",
           url: url,
           data: {'participant_name':id,'meetingID':meetingID}, // serializes the form's elements.
           
           success: function(data)
           {
                var data = JSON.parse(data);
                alert('User' + data.name + ' Added sucessfully for this meeting'); 
           }
         });


     }
});
</script>

</body>

</html>
